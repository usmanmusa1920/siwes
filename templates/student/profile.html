<!-- extending from base.html file -->
{% extends 'base.html' %}
{% load static %}

<!-- css file link -->
{% block css %}
  <link rel="stylesheet" href="{% static 'css/profile.css' %}">
{% endblock css %}

<!-- page title -->
{% block title %}
  <title>Student profile page</title>
{% endblock title %}

<!-- content of the page -->
{% block main %}
  <div class="main_wrapp_head">
    {% if student.matrix_no == request.user.identification_num %}
      <p>Your {{student.faculty.training}} profile</p>
    {% else %}
      <p>{{student.first_name}}`s {{student.faculty.training}} profile</p>
    {% endif %}
  </div>

  <div class="main_wrapp">
    <div class="wrapp_img">
      <img src="{{student.student.profile.image.url}}" alt="">
    </div>

    <div class="wrapp_info">
      <div class="wrapp_info_left">
        <form method="POST" action="{% url 'auth:update_profile_img' %}" enctype="multipart/form-data">
          {% csrf_token %}
          <!-- if user profile image is the default one this field will be display in other to change it -->
          {% if request.user.profile.image.url == '/media/default_pic.png' %}
            Please upload your profile image:
            <div class="wrapp_form">
              <input type="file" name="image" accept="image/*" required>
              <div class="wrapp_info">
                <small>When uploading profile image make sure it has an extension of PGN, JPG, or JPEG</small>
              </div>
              <button type="submit">Upload</button>
            </div>
          {% endif %}
        </form>
        <p>
          <b>Name:</b>
          {{student.first_name}}
          {% if student.middle_name %}
            {{student.middle_name}}
          {% endif %}
          {{student.last_name}}
        </p>
        <p>
          <b>Matrix no:</b> {{student.matrix_no}}
        </p>
        <p>
          <b>Faculty:</b> {{student.faculty.name}}
        </p>
        <p>
          <b>Level:</b> {{student.level}}
        </p>
        {% if student.supervisor_id_200 %}
          <p>
            <b>Supervisor 200L: {{student.supervisor_id_200}}</b>
          </p>
          <a href="{% url 'chat:send_message' student.supervisor_id_200 %}" class="me_good">Message 300L supervisor</a>
        {% endif %}
        {% if student.supervisor_id_300 %}
          <p>
            <b>Supervisor 300L: {{student.supervisor_id_300}}</b>
          </p>
          <a href="{% url 'chat:send_message' student.supervisor_id_300 %}" class="me_good">Message 300L supervisor</a>
        {% endif %}
        <!-- <p>
          <b>Supervisor:</b>
          {% for supervisor in coord.training_supervisors.all %}
            {% if student in supervisor.training_students.all %}
              {% if student.level == 300 or student.level == '300' %}
                {% if student.is_assign_supervisor_300 %}
                  <i><b>{{supervisor}}</b></i> is your 300L supervisor
                {% endif %}
              {% else %}
                {% if student.is_assign_supervisor_200 %}
                  <i><b>{{supervisor}}</b></i> is your 200L supervisor
                {% endif %}
              {% endif %}
            {% endif %}
          {% endfor %}
        </p> -->
        <p>
          {% if student.faculty.name == "Science" %}
            <b>Department:</b> B.Sc {{student.department.name}}
          {% elif student.faculty.name == "Education" %}
            <b>Department:</b> B.Ed {{student.department.name}}
          {% else %}
            <b>Department:</b> {{student.department.name}}
          {% endif %}
        </p>
        <br>
        <hr>
        <a href="{% url 'auth:student_profile_update' %}" class="good_me">Edit profile</a>
        <br>
        <br>
        <a href="{% url 'chat:send_message' coord.id_no %}" class="me_good">Message coordinator</a>
      </div>

      {% if student.matrix_no == request.user.identification_num %}
        <div class="wrapp_info_right">
          <!-- 200 level -->
          {% if student.is_apply_training_200 %}
            {% if acceptance_200 %}
              <a href="{% url 'student:upload_acceptance_letter_page' 200 %}" class="good_me">View acceptance letter for 200</a>
              <br>
              <br>
              <a href="{% url 'student:logbook_entry' request.user.identification_num 200 %}" class="good_me">Logbook entry 200</a>
              <br>
              <br>
            {% else %}
              <a href="{% url 'student:upload_acceptance_letter_page' 200 %}" class="good_me">Upload acceptance letter for 200</a>
              <br>
              <br>
            {% endif %}
            {% if letter_a_200 or letter_p_200 %}
              <a href="{% url 'student:placement_letter' 200 %}" class="good_me">Placement letter for 200</a>
              <br>
              <br>
              <a href="{% url 'student:acceptance_letter' 200 %}" class="good_me">Acceptance letter for 200</a>
              <br>
              <br>
            {% endif %}
          {% else %}
            <a href="{% url 'student:apply_training' 200 %}" class="good_me">Apply training for 200</a>
            <br>
            <br>
          {% endif %}

          <!-- 300 level -->
          {% if student.level == '300' %}
            <hr>
            <br>
            {% if student.is_apply_training_300 %}
              {% if acceptance_300 %}
                <a href="{% url 'student:upload_acceptance_letter_page' 300 %}" class="me_good">View acceptance letter for 300</a>
                <br>
                <br>
                <a href="{% url 'student:logbook_entry' request.user.identification_num 300 %}" class="me_good">Logbook entry 300</a>
                <br>
                <br>
              {% else %}
                <a href="{% url 'student:upload_acceptance_letter_page' 300 %}" class="me_good">Upload acceptance letter for 300</a>
              {% endif %}
              {% if letter_a_300 or letter_p_300 %}
                <a href="{% url 'student:placement_letter' 300 %}" class="me_good">Placement letter for 300</a>
                <br>
                <br>
                <a href="{% url 'student:acceptance_letter' 300 %}" class="me_good">Acceptance letter for 300</a>
                <br>
                <br>
              {% endif %}
            {% else %}
              <a href="{% url 'student:apply_training' 300 %}" class="me_good">Apply training for 300</a>
              <br>
              <br>
            {% endif %}
          {% endif %}
        </div>
      {% endif %}
    </div>

    <div class="wrapp_level">
      {% if student.matrix_no == request.user.identification_num %}
        <div>
          {% if acceptance_200 %}
            Your 200 level acceptance is available
          {% else %}
            Your 200 level acceptance is pending
          {% endif %}
        </div>
        {% if student.level == "300" %}
          <div>
            {% if acceptance_300 %}
              Your 300 level acceptance is available
            {% else %}
              Your 300 level acceptance is pending
            {% endif %}
          </div>
        {% endif %}
      {% else %}
        <div>
          {% if acceptance_200 %}
            {{student.first_name}}`s 200 level acceptance is available
          {% else %}
            {{student.first_name}}`s 200 level acceptance is pending
          {% endif %}
        </div>
        {% if student.level == "300" %}
          <div>
            {% if acceptance_300 %}
              {{student.first_name}}`s 300 level acceptance is available
            {% else %}
              {{student.first_name}}`s 300 level acceptance is pending
            {% endif %}
          </div>
        {% endif %}
      {% endif %}
    </div>

    <div class="main_wrapp_what">
      {% if student.matrix_no == request.user.identification_num %}
        <p>This is your {{student.faculty.training}} profile</p>
      {% else %}
        <p>This is {{student.first_name}}`s {{student.faculty.training}} profile</p>
      {% endif %}
    </div>
  </div>
{% endblock main %}
